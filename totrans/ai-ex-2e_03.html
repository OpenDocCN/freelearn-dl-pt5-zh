<html><head></head><body>
  <div id="_idContainer049">
    <h1 class="chapterNumber">3</h1>
    <h1 id="_idParaDest-45" class="chapterTitle">Machine Intelligence – Evaluation Functions and Numerical Convergence</h1>
    <p class="normal">Two issues appear when a reward matrix (<em class="italics">R</em>)-driven MDP produces results. These issues can be summed up in two principles.</p>
    <p class="normal"><strong class="bold">Principle 1</strong>: AI algorithms often surpass humans in classification, prediction, and decision-making areas.</p>
    <p class="normal">The key executive function of human intelligence, decision-making, relies on the ability to evaluate a situation. No decision can be made without measuring the pros and cons and factoring the parameters.</p>
    <p class="normal">Humanity takes great pride in its ability to evaluate. However, in many cases, a machine can do better. Chess represents our pride in our thinking ability. A chessboard is often present in movies to symbolize human intelligence.</p>
    <p class="normal">Today, not a single chess player can beat the best chess engines. One of the extraordinary core capabilities of a chess engine is the evaluation function; it takes many parameters into account more precisely than humans.</p>
    <p class="normal"><strong class="bold">Principle 2</strong>: Principle 1 leads to a very tough consequence. It is sometimes possible and other times impossible for a human to verify the results that an AI algorithm produces, let alone ensemble meta-algorithms.</p>
    <p class="normal">Principle 1 has been difficult to detect because of the media hype surrounding face and object recognition. It is easy for a human to check whether the face or object the ML algorithm was supposed to classify was correctly classified.</p>
    <p class="normal">However, in a decision-making process involving many features, principle 2 rapidly appears. In this chapter, we will identify what results and convergence to measure and decide how to measure it. We will also explore measurement and evaluation methods.</p>
    <p class="normal">This chapter covers the following topics:</p>
    <ul>
      <li class="list">Evaluation of the episodes of a learning session</li>
      <li class="list">Numerical convergence measurements</li>
      <li class="list">An introduction to numerical gradient descent</li>
      <li class="list">Decision tree supervised learning as an evaluation method</li>
    </ul>
    <p class="normal">The first thing is to set evaluation goals. To do this, we will decide what to measure and how.</p>
    <h1 id="_idParaDest-46" class="title">Tracking down what to measure and deciding how to measure it</h1>
    <p class="normal">We will now <a id="_idIndexMarker091"/>tackle the tough task of finding the factors that can make a system go wrong.</p>
    <p class="normal">The model built in the previous chapters can be summed up as follows:</p>
    <figure class="mediaobject"><img style="height: 6em !important" src="../Images/B15438_03_001.png" alt=""/></figure>
    <p class="normal">From <em class="italics">l</em><sub style="font-style: italic;">v</sub>, the availability vector (capacity in a warehouse, for example), to <em class="italics">R</em>, the process creates the reward matrix from the raw data (<em class="italics">Chapter 2</em>, <em class="italics">Building a Reward Matrix – Designing Your Datasets</em>) required for the MDP reinforcement learning program (<em class="italics">Chapter 1</em>, <em class="italics">Getting Started with Next-Generation Artificial Intelligence through Reinforcement Learning</em>). As described in the previous chapter, a softmax(<em class="italics">l</em><sub style="font-style: italic;">v</sub>) function is applied to <em class="italics">l</em><sub style="font-style: italic;">v</sub>. In turn, a one-hot(softmax(<em class="italics">l</em><sub style="font-style: italic;">v</sub>)) is applied, which is then converted into the reward value <em class="italics">R</em>, which will be used for the <em class="italics">Q</em> (Q-learning) algorithm.</p>
    <p class="normal">The MDP-driven Bellman equation then runs from reading <em class="italics">R</em> (the reward matrix) to the results. Gamma is the learning parameter, <em class="italics">Q</em> is the Q-learning function, and the results represent the final value of the states of the process.</p>
    <p class="normal">The parameters to be measured are as follows:</p>
    <ul>
      <li class="list">The company's input data. Ready-to-use datasets such as MNIST are designed to be efficient for an exploration phase. These ready-made datasets often contain some noise (unreliable data) to make them realistic. The same process must be achieved with raw company data. The only problem is that you cannot download a corporate dataset from somewhere. You have to build time-consuming datasets.</li>
      <li class="list">The weights and biases that will be applied.</li>
      <li class="list">The activation function (a logistic function or other).</li>
      <li class="list">The choices to make after the one-hot process.</li>
      <li class="list">The learning parameter.</li>
      <li class="list">Episode management through convergence.</li>
      <li class="list">A verification process through interactive random checks and independent algorithms such as supervised learning to control unsupervised algorithms.</li>
    </ul>
    <p class="normal">In real-life company <a id="_idIndexMarker092"/>projects, a system will not be approved until tens of thousands of results have been produced. In some cases, a corporation will approve the system only after hundreds of datasets with millions of data samples have been tested to be sure that all scenarios are accurate. Each dataset represents a scenario that consultants can work on with parameter scripts. The consultant introduces parameter scenarios that are tested by the system and measured. In decision-making systems with up to 200 parameters, a consultant will remain necessary for months in an industrial environment. A reinforcement learning program will be on its own to calculate events. However, even then, consultants are needed to manage the hyperparameters. In real-life systems, with high financial stakes, quality control will always remain essential.</p>
    <p class="normal">Measurement should thus apply to generalization more than simply applying to a single or few datasets. Otherwise, you will have a natural tendency to control the parameters and overfit your model in a too-good-to-be-true scenario. </p>
    <p class="normal">For example, say you wake up one morning and look at the sky. The weather is clear, the sun is shining, and there are no clouds. The next day, you wake up and you see the same weather. You write this down in a dataset and send it off to a customer for weather prediction. Every time the customer runs the program, it predicts clear sunny skies! That what overfitting leads to! This explains why we need large datasets to fully understand how to use an algorithm or illustrate how a machine learning program works.</p>
    <p class="normal">Beyond the reward matrix, the reinforcement program in the first chapter had a learning parameter <img style="height: 0.75em !important; vertical-align: baseline;" src="../Images/B15438_03_003.png" alt=""/>, shown in <code class="Code-In-Text--PACKT-">mdp03.py</code>, which is used for this section:</p>
    <pre class="programlisting"><code class="hljs ini"><span class="hljs-comment"># Gamma: It's a form of penalty or uncertainty for learning</span>
<span class="hljs-comment"># If the value is 1, the rewards would be too high.</span>
<span class="hljs-comment"># This way the system knows it is learning.</span>
<span class="hljs-attr">gamma</span> = <span class="hljs-number">0.8</span>
</code></pre>
    <p class="normal">The <img style="height: 0.85em !important; vertical-align: baseline;" src="../Images/B15438_03_004.png" alt=""/> learning <a id="_idIndexMarker093"/>parameter in itself needs to be closely monitored because it introduces uncertainty into the system. This means that the learning process will always remain a probability, never a certainty. One might wonder why this parameter is not just taken out. Paradoxically, that will lead to even more global uncertainty. The more the <img style="height: 0.85em !important; vertical-align: baseline;" src="../Images/B15438_03_004.png" alt=""/> learning parameter tends to 1, the more you risk overfitting your results. Overfitting means that you are pushing the system to think it's learning well when it isn't. It's exactly like a teacher who gives high grades to everyone in the class all the time. The teacher would be overfitting the grade-student evaluation process, and nobody would know whether the students have learned anything.</p>
    <p class="normal">The results of the reinforcement program need to be measured as they go through episodes. The range of the learning process itself must be measured.</p>
    <p class="normal">All of these measurements will have a significant effect on the results obtained.</p>
    <p class="normal">The best way to start is by measuring the quality of convergence of the system.</p>
    <p class="normal">If the system provides good convergence, you might avoid the headache of having to go back and check everything.</p>
    <h2 id="_idParaDest-47" class="title">Convergence</h2>
    <p class="normal">Convergence <a id="_idIndexMarker094"/>measures the distance between the present state of a training session and the goal of the training session. In a reinforcement learning program, an MDP, for example, there is no training data, so there is no target data to compare to.</p>
    <p class="normal">However, two methods are available:</p>
    <ol>
      <li class="list"><strong class="bold">Implicit convergence</strong>: In <a id="_idIndexMarker095"/>this case, we run the training for a large <a id="_idIndexMarker096"/>number of episodes, 50,000, for example. We know through trial and error that the program will reach a solution by then.</li>
      <li class="list"><strong class="bold">Numerically controlled gradient descent</strong>: We <a id="_idIndexMarker097"/>measure the training progress<a id="_idIndexMarker098"/> at each episode and stop when it is safe to do so.</li>
    </ol>
    <h3 id="_idParaDest-48" class="title">Implicit convergence</h3>
    <p class="normal">In the last<a id="_idIndexMarker099"/> part of <code class="Code-In-Text--PACKT-">mdp01.py</code> in the first chapter, a range of 50,000 <a id="_idIndexMarker100"/>was implemented. In this chapter, we will run <code class="Code-In-Text--PACKT-">mdp03.py</code>.</p>
    <p class="normal">In the last part of <code class="Code-In-Text--PACKT-">mdp01.py</code>, the idea was to set the number of episodes at such a level that meant that convergence was certain. In the following code, the range (<code class="Code-In-Text--PACKT-">50000</code>) is a constant:</p>
    <pre class="programlisting"><code class="hljs fortran">for i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50000</span>):
    current_state = ql.random.randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">int</span>(Q.<span class="hljs-built_in">shape</span>[<span class="hljs-number">0</span>]))
    PossibleAction = possible_actions(current_state)
    <span class="hljs-keyword">action</span> = ActionChoice(PossibleAction)
    reward(current_state,<span class="hljs-keyword">action</span>,<span class="hljs-built_in">gamma</span>)
</code></pre>
    <p class="normal">Convergence, in this case, will be defined as the point at which no matter how long you run the system, the <code class="Code-In-Text--PACKT-">Q</code> result matrix will not change anymore.</p>
    <p class="normal">By setting the range to <code class="Code-In-Text--PACKT-">50000</code>, you can test and verify this. As long as the reward matrices remain homogeneous, this will work. If the reward matrices strongly vary from one scenario to another, this model will produce unstable results.</p>
    <p class="normal">Try to run the program with different ranges. Lower the ranges until you see that the results are not optimal.</p>
    <h3 id="_idParaDest-49" class="title">Numerically controlled gradient descent convergence</h3>
    <p class="normal">In this section, we <a id="_idIndexMarker101"/>will use <code class="Code-In-Text--PACKT-">mdp03.py</code>, a <a id="_idIndexMarker102"/>modified version of <code class="Code-In-Text--PACKT-">mdp01.py</code> explored in <em class="italics">Chapter 1</em>, with an additional function: numerically controlled gradient descent.</p>
    <p class="normal">Letting the MDP train for 50,000 will produce a good result but consume unnecessary CPU. Using a numerically controlled gradient descent evaluation function will save a lot of episodes. Let's see how many.</p>
    <p class="normal">First, we need to define the gradient descent function based on a derivative. Let's have a quick review of what a derivative is.</p>
    <figure class="mediaobject"><img style="height: 2.5em !important" src="../Images/B15438_03_006.png" alt=""/></figure>
    <p class="normal"><em class="italics">h</em> is the value of the<a id="_idIndexMarker103"/> step of the function. Imagine that <em class="italics">h</em> represents each line of a bank account statement. If we read the statement line by line, <em class="italics">h</em> = 1. If we read two lines at a time, <em class="italics">h</em> = 2.</p>
    <p class="normal">Reading the present line of the bank account statement = <em class="italics">f</em>(<em class="italics">x</em>) = <em class="italics">a certain amount</em>.</p>
    <p class="normal">When you read the next line of the bank account, the function is (<em class="italics">f</em> + <em class="italics">h</em>) = <em class="italics">the amount after f</em>(<em class="italics">x</em>). If you had 100 units of currency in your bank account at <em class="italics">f</em>(<em class="italics">x</em>) and spent 10 units of currency, on the next line, <em class="italics">x</em> + <em class="italics">h</em>, you would have <em class="italics">f</em>(<em class="italics">x</em> + <em class="italics">h</em>) = <em class="italics">90 units of currency</em> left.</p>
    <p class="normal">The gradient provides the <a id="_idIndexMarker104"/>direction of your slope: up, down, or constant. In this case, we can say <a id="_idIndexMarker105"/>that the slope, the <strong class="bold">gradient</strong>, is doing downward, as shown in the following graph, which illustrates the decreasing values of <em class="italics">y</em>(cost, loss) as <em class="italics">x</em> increases (training episodes):</p>
    <figure class="mediaobject"><img src="../Images/B15438_03_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.1: Plotting the decreasing cost/loss values as training episodes increase</p>
    <p class="normal">We also need to know by how much your bank account is changing – how much the <strong class="bold">derivative</strong> is worth. In this case, derivative means by how much the balance of your bank <a id="_idIndexMarker106"/>account is <a id="_idIndexMarker107"/>changing on each line of your bank statement. In this case, you spent 10 units of currency in one bank statement line, so the derivative at this value of <em class="italics">x</em> (line in your bank account) = –10.</p>
    <p class="normal">In the following code of the<a id="_idIndexMarker108"/> Bellman equation as seen in <em class="italics">Chapter 1</em>, <em class="italics">Getting Started with Next-Generation Artifcial Intelligence through Reinforcement Learning</em>, the step of the loop is 1 as well:</p>
    <pre class="programlisting"><code class="hljs matlab"><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span> in range(<span class="hljs-built_in">sec</span>):
</code></pre>
    <p class="normal">Since <em class="italics">i</em> = 1, <em class="italics">h</em> = 1 in our gradient descent calculation can be simplified:</p>
    <figure class="mediaobject"><img style="height: 2.5em !important" src="../Images/B15438_03_007.png" alt=""/></figure>
    <p class="normal">We now define <em class="italics">f</em>(<em class="italics">x</em>) in the following code:</p>
    <pre class="programlisting"><code class="hljs ini"><span class="hljs-attr">conv</span>=Q.sum()
</code></pre>
    <p class="normal"><code class="Code-In-Text--PACKT-">conv</code> is the sum of the 6×6 <code class="Code-In-Text--PACKT-">Q</code> matrix that is slowly filling up as the MDP training progresses. Thus <em class="italics">f</em>(<em class="italics">x</em>) = <code class="Code-In-Text--PACKT-">conv=Q.sum()</code> = sum of <code class="Code-In-Text--PACKT-">Q</code>. The function adds up all the values in <code class="Code-In-Text--PACKT-">Q</code> to have a precise value of the state of the system at each <em class="italics">i</em>.</p>
    <p class="normal"><em class="italics">f</em>(<em class="italics">x</em>) = the state of the system at <em class="italics">i</em> – 1</p>
    <p class="normal"><em class="italics">f</em>(<em class="italics">x</em> + 1) is the value of the system at <em class="italics">i</em>:</p>
    <pre class="programlisting"><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Q</span>.</span></span>sum<span class="hljs-literal">()</span>
</code></pre>
    <p class="normal">We must remember that the <code class="Code-In-Text--PACKT-">Q</code> matrix is increasing progressively as the MDP process continues to train. We measure the distance between two steps, <em class="italics">h</em>. This distance will decrease. Now we have:</p>
    <p class="center"><em class="italics">f</em>(<em class="italics">x</em> + 1) – <em class="italics">f</em>(<em class="italics">x</em>) = <code class="Code-In-Text--PACKT-">-Q.sum()+conv</code></p>
    <ul>
      <li class="list">First we implement additional variables for our evaluation function, which uses gradient descent at line 83 of <code class="Code-In-Text--PACKT-">mdp01.py</code>:
        <pre class="programlisting"><code class="hljs ini"><span class="hljs-attr">ci</span>=<span class="hljs-number">0</span>          <span class="hljs-comment"># convergence counter which counts the number of episodes</span>
<span class="hljs-attr">conv</span>=<span class="hljs-number">0</span>        <span class="hljs-comment"># sum of Q at state 1 and then every x episodes</span>
<span class="hljs-attr">nc</span>=<span class="hljs-number">1</span>          <span class="hljs-comment"># numerical convergence activated to perform numerical-controlled gradient descent</span>
<span class="hljs-attr">xi</span>=<span class="hljs-number">100</span>        <span class="hljs-comment"># xi episode optimizer: stop as soon as convergence reached + xi-x(unknown)</span>
<span class="hljs-attr">sec</span>=<span class="hljs-number">2500</span>      <span class="hljs-comment"># security number of episodes for this matrix size brought down from 50,000 to 2,500</span>
<span class="hljs-attr">cq</span>=ql.zeros((<span class="hljs-number">2500</span>, <span class="hljs-number">1</span>))
</code></pre>
      </li>
      <li class="list"><code class="Code-In-Text--PACKT-">nc=1</code> activates the evaluation function, and <code class="Code-In-Text--PACKT-">ci</code> begins to count the episodes it will take with this function:
        <pre class="programlisting"><code class="hljs angelscript"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(sec):
    current_state = ql.random.randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">int</span>(Q.shape[<span class="hljs-number">0</span>]))
    PossibleAction = possible_actions(current_state)
    action = ActionChoice(PossibleAction)
    reward(current_state,action,gamma)
    ci+=<span class="hljs-number">1</span>                          # convergence counter incremented by <span class="hljs-number">1</span> at each state
    <span class="highlight"><span class="hljs-keyword">if</span>(nc==<span class="hljs-number">1</span>):</span>                      # numerical convergence activated
</code></pre>
      </li>
      <li class="list">At the<a id="_idIndexMarker109"/> first<a id="_idIndexMarker110"/> episode, <code class="Code-In-Text--PACKT-">i==1</code>, <em class="italics">f</em>(<em class="italics">x</em>)= <code class="Code-In-Text--PACKT-">Q.sum()</code> as planned:
        <pre class="programlisting"><code class="hljs nix">        <span class="hljs-keyword">if</span>(<span class="hljs-attr">i==1):</span>               <span class="hljs-comment"># at state one, conv is activated</span>
            <span class="hljs-attr">conv=Q.sum()</span>    <span class="hljs-comment"># conv= the sum of Q</span>
</code></pre>
      </li>
      <li class="list"><em class="italics">f</em>(<em class="italics">x</em> + 1) = <code class="Code-In-Text--PACKT-">-Q.sum()+conv</code> is applied:
        <pre class="programlisting"><code class="hljs routeros">        <span class="hljs-builtin-name">print</span>(<span class="hljs-string">"Episode"</span>,i,<span class="hljs-string">"Local derivative:"</span>,-Q.sum()+conv,<span class="hljs-built_in">..</span>.
</code></pre>
      </li>
      <li class="list">The distance, the absolute value of the derivative, is displayed and stored because we will be using it to plot a figure with Matplotlib:
        <pre class="programlisting"><code class="hljs perl">        <span class="hljs-keyword">print</span>(... <span class="hljs-string">"Numerical Convergence value estimator"</span>,
            Q.sum()-conv)
                c<span class="hljs-string">q[i]</span>[<span class="hljs-number">0</span>]=Q.sum()-conv
</code></pre>
      </li>
      <li class="list"><code class="Code-In-Text--PACKT-">xi=100</code> plays a critical role in this numerically controlled gradient descent function. Every <code class="Code-In-Text--PACKT-">xi</code>, the process stops to check the status of the training process:
        <pre class="programlisting"><code class="hljs routeros">    <span class="hljs-keyword">if</span>(<span class="hljs-attribute">ci</span>==xi):   # every 100 episodes the<span class="hljs-built_in"> system </span>checks <span class="hljs-keyword">to</span> see<span class="hljs-built_in">..</span>.
</code></pre>
      </li>
    </ul>
    <p class="normal">There are two possible cases: <strong class="bold">a)</strong> and <strong class="bold">b)</strong>.</p>
    <p class="normal"><strong class="bold">Case a)</strong> As long as the local derivative is &gt;0 at each episode, the MDP continues its training process:</p>
    <pre class="programlisting"><code class="hljs livecodeserver">            <span class="hljs-keyword">if</span>(conv!=Q.<span class="hljs-built_in">sum</span>()): <span class="hljs-comment"># if the sum of Q changes...</span>
                conv=Q.<span class="hljs-built_in">sum</span>()   <span class="hljs-comment"># ...the training isn't over, conv is updated</span>
                ci=<span class="hljs-number">0</span>           <span class="hljs-comment"># ...the convergence counter is set to O</span>
</code></pre>
    <p class="normal">The output will display varying local derivatives:</p>
    <pre class="programlisting"><code class="hljs angelscript">Episode <span class="hljs-number">1911</span> Local derivative: <span class="hljs-number">-9.094947017729282e-13</span> Numerical Convergence value estimator <span class="hljs-number">9.094947017729282e-13</span>
Episode <span class="hljs-number">1912</span> Local derivative: <span class="hljs-number">-9.094947017729282e-13</span> Numerical Convergence value estimator <span class="hljs-number">9.094947017729282e-13</span>
Episode <span class="hljs-number">1913</span> Local derivative: <span class="hljs-number">-1.3642420526593924e-12</span> Numerical Convergence value estimator <span class="hljs-number">1.3642420526593924e-12</span>
</code></pre>
    <p class="normal"><strong class="bold">Case b)</strong> When the derivative value reaches a constant value for <code class="Code-In-Text--PACKT-">xi</code> episodes, the MDP has been trained and the training can now stop:</p>
    <pre class="programlisting"><code class="hljs gauss">            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">conv</span>==Q.<span class="hljs-built_in">sum</span>()):        <span class="hljs-meta"># ...if the sum of Q has changed</span>
                <span class="hljs-keyword">print</span>(i,<span class="hljs-built_in">conv</span>,Q.<span class="hljs-built_in">sum</span>()) <span class="hljs-meta"># ...if it hasn't the training is over</span>
                <span class="hljs-keyword">break</span>                 <span class="hljs-meta"># ...the system stops training</span>
</code></pre>
    <p class="normal">The output <a id="_idIndexMarker111"/>will display a constant <a id="_idIndexMarker112"/>derivate, <code class="Code-In-Text--PACKT-">xi</code>, before the training stops:</p>
    <pre class="programlisting"><code class="hljs angelscript">Episode <span class="hljs-number">2096</span> Local derivative: <span class="hljs-number">0.0</span> Numerical Convergence value estimator <span class="hljs-number">0.0</span>
Episode <span class="hljs-number">2097</span> Local derivative: <span class="hljs-number">0.0</span> Numerical Convergence value estimator <span class="hljs-number">0.0</span>
Episode <span class="hljs-number">2098</span> Local derivative: <span class="hljs-number">0.0</span> Numerical Convergence value estimator <span class="hljs-number">0.0</span>
Episode <span class="hljs-number">2099</span> Local derivative: <span class="hljs-number">0.0</span> Numerical Convergence value estimator <span class="hljs-number">0.0</span>
</code></pre>
    <p class="normal">When the training is over, the number of training episodes is displayed:</p>
    <pre class="programlisting"><code class="hljs yaml"><span class="hljs-attr">number of episodes:</span> <span class="hljs-number">2099</span>
</code></pre>
    <p class="normal">2,099 is a lot less than the 50,000 implicit convergence episodes, which proves the efficiency of this numerically controlled gradient descent method.</p>
    <p class="normal">At the end of the learning process, you can display a Matplotlib figure containing the convergence level of each episode that we had stored in <code class="Code-In-Text--PACKT-">cq=ql.zeros((2500, 1))</code>:</p>
    <pre class="programlisting"><code class="hljs perl">            c<span class="hljs-string">q[i]</span>[<span class="hljs-number">0</span>]=Q.sum()-conv
</code></pre>
    <p class="normal">The figure is displayed with a few lines of code:</p>
    <pre class="programlisting"><code class="hljs less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">matplotlib</span><span class="hljs-selector-class">.pyplot</span> <span class="hljs-selector-tag">as</span> <span class="hljs-selector-tag">plt</span>
<span class="hljs-selector-tag">plt</span><span class="hljs-selector-class">.plot</span>(cq)
<span class="hljs-selector-tag">plt</span><span class="hljs-selector-class">.xlabel</span>(<span class="hljs-string">'Episodes'</span>)
<span class="hljs-selector-tag">plt</span><span class="hljs-selector-class">.ylabel</span>(<span class="hljs-string">'Convergence Distances'</span>)
<span class="hljs-selector-tag">plt</span><span class="hljs-selector-class">.show</span>()
</code></pre>
    <figure class="mediaobject"><img src="../Images/B15438_03_02.png" alt="Une image contenant capture d’écran  Description générée automatiquement"/></figure>
    <p class="packt_figref">Figure 3.2: A plot demonstrating numerical convergence</p>
    <p class="normal">This graph shows the numerical convergence. As you can see in the graph, the cost or loss decreases as the number of training episodes increases, as explained earlier in this chapter.</p>
    <p class="normal">Please note the <a id="_idIndexMarker113"/>following properties of <a id="_idIndexMarker114"/>this gradient descent method:</p>
    <ul>
      <li class="list">The number of episodes will vary from one training session to another because the MDP is a random process.</li>
      <li class="list">The training curve at local episodes is sometimes erratic because of the random nature of the training process. Sometimes, the curve will go up instead of down locally. In the end, it will reach 0 and stay there.</li>
      <li class="list">If the training curve increases locally, there is nothing you can do. An MDP does no backpropagation to modify weights, parameters, or strategies, as we will see when we look at artificial neural networks (ANNs), for example, in <em class="italics">Chapter 8</em>, <em class="italics">Solving the XOR Problem with a Feedforward Neural Network</em>. No action is required in an MDP process. You can try to change the learning rate or go back and check your reward matrix and the preprocessing phase implemented on the raw datasets.</li>
      <li class="list">If the training curve does not reach 0 and stay there, check the learning parameters, the reward matrix, and the preprocessing phase implemented on the raw datasets. You might even have to go back and check the noise (defective data or missing data) in the initial datasets.</li>
    </ul>
    <p class="normal">Once the MDP training is over, do some random tests using the functionality provided at line 145 and explained in <em class="italics">Chapter 1</em>:</p>
    <pre class="programlisting"><code class="hljs isbl"><span class="hljs-variable">origin</span>=<span class="hljs-function"><span class="hljs-title">int</span>(<span class="hljs-title">input</span>(<span class="hljs-string">"index number origin(A=0,B=1,C=2,D=3,E=4,F=5): "</span>))</span>
</code></pre>
    <p class="normal">For example, when prompted for an input, enter <code class="Code-In-Text--PACKT-">1</code> and see if the result is correct, as shown in the following output:</p>
    <pre class="programlisting"><code class="hljs angelscript">index number origin(A=<span class="hljs-number">0</span>,B=<span class="hljs-number">1</span>,C=<span class="hljs-number">2</span>,D=<span class="hljs-number">3</span>,E=<span class="hljs-number">4</span>,F=<span class="hljs-number">5</span>): <span class="hljs-number">1</span>
…/…
print(<span class="hljs-string">"Path:"</span>)
-&gt; B
-&gt; D
-&gt; C
</code></pre>
    <p class="normal">This random test <a id="_idIndexMarker115"/>verification method will <a id="_idIndexMarker116"/>work efficiently with a relatively small reward matrix.</p>
    <p class="normal">However, this approach will prove difficult with a size 25×25 reward matrix, for example. The machine easily provides a result. But how can we evaluate it? In that case, we have reached the limit of human analytic capacity. In the preceding code, we entered a starting point and obtained an answer. With a small reward matrix, it is easy to visually check and see if the answer is correct. When analyzing 25 × 25 = 625 cells, it would take days to verify the results. For the record, bear in mind that when Andrey Markov invented his approach over 100 years ago, he used a pen and paper! However, we have computers, so we must use an evaluation algorithm to evaluate the results of our MDP process.</p>
    <p class="normal">The increasing volumes of data and parameters in a global world have made it impossible for humans to outperform the ever-growing intelligence of machines.</p>
    <h1 id="_idParaDest-50" class="title">Evaluating beyond human analytic capacity</h1>
    <p class="normal">An efficient manager <a id="_idIndexMarker117"/>has a high evaluation quotient. A machine often has a better one in an increasing number of fields. The problem for a human is to understand the evaluation machine intelligence has produced.</p>
    <p class="normal">Sometimes a human will say "that's a good machine thinking result" or "that's a bad result," without being able to explain why or determine whether there is a better solution.</p>
    <p class="normal">Evaluation is one of the major keys to efficient decision-making in all fields: from chess, production management, rocket launching, and self-driving cars to data center calibration, software development, and airport schedules.</p>
    <p class="normal">We'll explore a chess scenario to illustrate the limits of human evaluation.</p>
    <p class="normal">Chess engines are not high-level deep learning-based software. They rely heavily on evaluations and calculations. They evaluate much better than humans, and there is a lot to learn from them. The question now is to know whether any human can beat a chess engine or not. The answer is no.</p>
    <p class="normal">To evaluate a<a id="_idIndexMarker118"/> position in chess, you need to examine all the pieces, their quantitative value, their qualitative value, the cooperation between pieces, who owns each of the 64 squares, the king's safety, the bishop pairs, the knight positioning, and many other factors.</p>
    <p class="normal">Evaluating a position in a chess game shows why machines are surpassing humans in quite a few decision-making fields.</p>
    <p class="normal">The following scenario is after move 23 in the Kramnik-Bluebaum 2017 game. It cannot be correctly evaluated by humans. It contains too many parameters to analyze and too many possibilities.</p>
    <figure class="mediaobject"><img src="../Images/B15438_03_03.png" alt="https://packt-type-cloud.s3.amazonaws.com/uploads/sites/2134/2018/05/B09946_03_4-1-298x300.png"/></figure>
    <p class="packt_figref">Figure 3.3: Chess example scenario</p>
    <p class="normal">It is white's turn to play, and a close analysis shows that both players are lost at this point. In a tournament like this, they must each continue to keep a poker face. They often look at their position with a confident face to hide their dismay. Some even shorten their thinking time to make their opponent think they know where they are going.</p>
    <p class="normal">These unsolvable positions for humans are painless to solve with chess engines, even for cheap, high-quality chess engines on a smartphone. This can be generalized to all human activity that has become increasingly complex, unpredictable, and chaotic. Decision-makers will increasingly rely on AI to help them make the right choices.</p>
    <p class="normal">No human can play<a id="_idIndexMarker119"/> chess and evaluate the way a chess engine does by simply calculating the positions of the pieces, their squares of liberty, and many other parameters. A chess engine generates an evaluation matrix with millions of calculations. </p>
    <p class="normal">The following table is the result of an evaluation of only one position among many others (real and potential).</p>
    <table id="table001-3" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
        <col/>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Position evaluated</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">0,3</strong>
          </td>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">White</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">34</strong>
          </td>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <strong class="heading">Initial position</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">Position</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">Value</strong>
          </td>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <strong class="heading">Quality Value</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">Total Value</strong>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">a2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">a2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">a2-b2 small pawn island</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,05</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,05</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">b2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">b2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">a2-b2 small pawn island</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,05</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,05</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">c2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">x</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Captured</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">d2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">d4</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Occupies center, defends Be5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,25</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,25</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">e2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">e2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Defends Qf3</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,25</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,25</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">f2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">x</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Captured</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">g2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">g5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Unattacked, attacking 2 squares</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,3</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,3</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">h2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">h3</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Unattacked, defending g4</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,1</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Rook</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">a1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">c1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Occupying c-file, attacking b7 with Nd5-Be5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">6</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Knight</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">b1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">d5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Attacking Nb6, 8 squares</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3,5</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">BishopDS</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">c1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">e5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Central position, 10 squares, attacking c7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3,5</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Queen</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">d1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">f3</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">9</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Battery with Bg2, defending Ne5, X-Ray b7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">11</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">King</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">e1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">h1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">X-rayed by Bb6 on a7-g1 diagonal</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">-0,5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">-0,5</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">BishopWS</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">f1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">g2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Supporting Qf3 in defense and attack</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3,5</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Knight</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">g1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">x</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Captured</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Rook</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">h1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">x</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Captured</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <p class="content">29</p>
          </td>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <p class="content">5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">34</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <p class="content">White: 34</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">The value of the <a id="_idIndexMarker120"/>position of white is 34.</p>
    <table id="table002-1" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
        <col/>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">White</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">34</strong>
          </td>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Black</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">33,7</strong>
          </td>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <strong class="heading">Initial position</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">Position</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">Value</strong>
          </td>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <strong class="heading">Quality Value</strong>
          </td>
          <td class="No-Table-Style">
            <strong class="heading">Total Value</strong>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">a7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">a7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">a7-b7 small pawn island</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,05</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,05</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">b7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">b7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">a7-b7 small pawn island</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,05</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,05</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">c7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">x</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Captured</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">d7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">x</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Captured</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">e7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">f5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Doubled, 2 squares</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">f7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">f7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">g7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">g6</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Defending f5 but abandoning Kg8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Pawn</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">h7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">h5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Well advanced with f5,g6</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,1</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Rook</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">a8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">d8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Semi-open d-file attacking Nd5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">7</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Knight</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">b8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">x</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Captured</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">BishopDS</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">c8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">b6</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Attacking d4, 3 squares</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3,5</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Queen</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">d8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">e6</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">9</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Attacking d4,e5, a bit cramped</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1,5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">10,5</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">King</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">e8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">g8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">f6,h6, g7,h8 attacked</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">-1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">-1</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">BishopWS</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">f8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">x</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Captured, white lost bishop pair</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">0,5</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Knight</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">g8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">e8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Defending c7,f6,g7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">1</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">4</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <strong class="heading">Rook</strong>
          </td>
          <td class="No-Table-Style">
            <p class="content">h8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">f8</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">5</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Out of play</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">-2</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">3</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <p class="content">31</p>
          </td>
          <td class="No-Table-Style"/>
          <td class="No-Table-Style">
            <p class="content">2,7</p>
          </td>
          <td class="No-Table-Style">
            <p class="content">Black: 33,7</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">The value of black is 33.7.</p>
    <p class="normal">So white is winning by 34 – 33.7 = 0.3.</p>
    <p class="normal">The evaluation system<a id="_idIndexMarker121"/> can easily be represented with two McCulloch-Pitts neurons, one for black and one for white. Each neuron would have 30 weights = {<em class="italics">w</em><sub>1</sub>,<em class="italics">w</em><sub>2</sub> … <em class="italics">w</em><sub>30</sub>}, as shown in the previous table. The sum of both neurons requires an activation function that converts the evaluation into 1/100th of a pawn, which is the standard measurement unit in chess. Each weight will be the output of squares and piece calculations. Then the MDP can be applied to Bellman's equation with a random generator of possible positions.</p>
    <p class="normal">Present-day chess engines contain this type of brute calculation approach. They don't need more to beat humans.</p>
    <p class="normal">No human, not even world champions, can calculate these positions with this accuracy. The number of parameters to take into account overwhelms them each time they reach positions like these. They then play more or less randomly with a possibly good idea in mind. The chances of success against a chess engine resemble a lottery sometimes. Chess experts discover this when they run human-played games with powerful chess engines to see how the game plays out. The players themselves now tend to reveal their incapacity to provide a deep analysis when asked why they made a questionable move. It often takes hours to go through a game, its combinations and find the reasons of a bad move. In the end, the players will often use a machine to help them understand what happened.</p>
    <p class="normal">The positions analyzed here represent only one possibility. A chess engine will test millions of possibilities. Humans can test only a few.</p>
    <p class="normal">Measuring a result like this has nothing to do with natural human thinking. Only machines can think like that. Not only do chess engines solve the problem, but they are also impossible to beat.</p>
    <p class="normal"><em class="italics">Principle 1: At one point, there are problems humans face that only machines can solve.</em></p>
    <p class="normal"><em class="italics">Principle 2: Sometimes, it will be possible to verify the result of an ML system, sometimes not. However, we must try to find ways to check the result.</em></p>
    <p class="normal">One solution to solve the problem of principle 2 is to verify an unsupervised algorithm with a supervised algorithm through random samples.</p>
    <h1 id="_idParaDest-51" class="title">Using supervised learning to evaluate a result that surpasses human analytic capacity</h1>
    <p class="normal">More often than not, an <a id="_idIndexMarker122"/>AI solution exceeds a human's capacity to analyze a situation in detail. It is often too difficult for a human to understand the millions of calculations a machine made to reach a conclusion and explain it. To solve that problem, another AI, ML, or DL algorithm will provide assisted AI capability.</p>
    <p class="normal">Let's suppose the following:</p>
    <ul>
      <li class="list">The raw data preprocessed by the neural approach of <em class="italics">Chapter 2</em>, <em class="italics">Building a Reward Matrix – Designing Your Datasets</em>, works fine. The reward matrix looks fine.</li>
      <li class="list">The MDP-driven Bellman equation provides good reinforcement training results.</li>
      <li class="list">The convergence function and values work.</li>
      <li class="list">The results on this dataset look satisfactory but the results are questioned.</li>
    </ul>
    <p class="normal">A manager or user will always come up with a killer question: how can you prove that this will work with other datasets in the future and confirm 100% that the results are reliable?</p>
    <p class="normal">The only way to be sure that this whole system works is to run thousands of datasets with hundreds of thousands of product flows.</p>
    <p class="normal">The idea now is to use supervised learning to create an independent way of checking the results. One method is to use a decision tree to visualize some key aspects of the solution and be able to reassure the users and yourself that the system is reliable.</p>
    <p class="normal">Decision trees provide a white box approach with powerful functionality. In this section, we will limit the exploration to an intuitive approach. In <em class="italics">Chapter 5</em>, <em class="italics">How to Use Decision Trees to Enhance K-Means Clustering</em>, we will go into the theory of decision trees and random trees and explore more complex examples.</p>
    <p class="normal">In this model, the features of the input are analyzed so that we can classify them. The analysis can be transformed into decision trees depending on real-time data, to create a distribution representation to predict future outcomes.</p>
    <p class="normal">For this section, you can run the following program:</p>
    <p class="normal"><code class="Code-In-Text--PACKT-">Decision_Tree_Priority_classifier.py</code></p>
    <p class="normal">Or the following Jupyter notebook on Google Colaboratory:</p>
    <p class="normal"><code class="Code-In-Text--PACKT-">DTCH03.ipynb</code></p>
    <p class="normal">Google Colaboratory might have the two following packages installed:</p>
    <pre class="programlisting"><code class="hljs routeros">import collections       # <span class="hljs-keyword">from</span> Python library container datatypes
import pydotplus         # a Python<span class="hljs-built_in"> Interface </span><span class="hljs-keyword">to</span> Graphviz<span class="hljs-string">'s Dot language.(dot-V command line
</span></code></pre>
    <p class="normal">This could help you avoid installing them locally, which might take some time if you get a Graphviz requirement message.</p>
    <p class="normal">Both programs produce the same decision tree image:</p>
    <p class="normal"><code class="Code-In-Text--PACKT-">warehouse_example_decision_tree.png</code></p>
    <p class="normal">The intuitive description of this decision tree approach runs in 5 steps:</p>
    <p class="normal"><strong class="bold">Step 1</strong>: Represent the<a id="_idIndexMarker123"/> features of the incoming orders to store in a warehouse – for example:</p>
    <pre class="programlisting"><code class="hljs ini"><span class="hljs-attr">features</span> = [ <span class="hljs-string">'Priority/location'</span>, <span class="hljs-string">'Volume'</span>, <span class="hljs-string">'Flow_optimizer'</span> ]
</code></pre>
    <p class="normal">In this case, we will limit the model to three properties:</p>
    <ul>
      <li class="list">Priority/location, which is the most important property in a warehouse flow in this model</li>
      <li class="list">Volumes to transport</li>
      <li class="list">Optimizing priority – the financial and customer satisfaction property</li>
    </ul>
    <p class="normal"><strong class="bold">Step 2</strong>: Provide priority labels for the learning dataset:</p>
    <pre class="programlisting"><code class="hljs ini"><span class="hljs-attr">Y</span> = [<span class="hljs-string">'Low'</span>, <span class="hljs-string">'Low'</span>, <span class="hljs-string">'High'</span>, <span class="hljs-string">'High'</span>, <span class="hljs-string">'Low'</span>, <span class="hljs-string">'Low'</span>]
</code></pre>
    <p class="normal"><strong class="bold">Step 3</strong>: Providing the dataset input matrix, which is the output matrix of the reinforcement learning program. The values have been approximated but are enough to run the model. They simulate some of the intermediate decisions and transformations that occur during the decision process (ratios applied, uncertainty factors added, and other parameters). The input matrix is <code class="Code-In-Text--PACKT-">X</code>:</p>
    <pre class="programlisting"><code class="hljs angelscript">X = [[<span class="hljs-number">256</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>],
     [<span class="hljs-number">320</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>],
     [<span class="hljs-number">500</span>, <span class="hljs-number">1</span>,<span class="hljs-number">1</span>],
     [<span class="hljs-number">400</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>],
     [<span class="hljs-number">320</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>],
     [<span class="hljs-number">256</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>]]
</code></pre>
    <p class="normal">The features in step 1 apply to each column.</p>
    <p class="normal">The values in step 2 apply to every line.</p>
    <p class="normal">The values of the third column [0,1] are discrete indicators for the training session.</p>
    <p class="normal"><strong class="bold">Step 4</strong>: Run a standard decision tree classifier. This classifier will distribute the representations (distributed representations) into two categories:</p>
    <ul>
      <li class="list">The properties of high-priority orders</li>
      <li class="list">The properties of low-priority orders</li>
    </ul>
    <p class="normal">There are many types of algorithms. In this case, a standard <code class="Code-In-Text--PACKT-">sklearn</code> function is called to do the job, as shown in the following source code:</p>
    <pre class="programlisting"><code class="hljs ini"><span class="hljs-attr">classify</span> = tree.DecisionTreeClassifier()
<span class="hljs-attr">classify</span> = classify.fit(X,Y)
</code></pre>
    <p class="normal"><strong class="bold">Step 5</strong>: Visualization separates the orders into priority groups. Visualizing the tree is optional but provides a trendy white box approach. You will have to use:</p>
    <ul>
      <li class="list"><code class="Code-In-Text--PACKT-">import collections</code>, a Python container library.</li>
      <li class="list"><code class="Code-In-Text--PACKT-">import pydotplus</code>, a Python interface to Graphviz's dot language. You can choose to use Graphviz directly with other variations of this source code.</li>
    </ul>
    <p class="normal">The source code will <a id="_idIndexMarker124"/>take the nodes and edges of the decision tree, draw them, and save the image in a file as follows:</p>
    <pre class="programlisting"><code class="hljs maxima">info = tree.export_graphviz(classify,feature_names=<span class="hljs-built_in">features</span>,
    out_file=None, filled=True,rounded=True)
graph = pydotplus.graph_from_dot_data(info)
<span class="hljs-built_in">edges</span> = collections.defaultdict(list)
<span class="hljs-keyword">for</span> edge <span class="hljs-keyword">in</span> graph.get_edge_list():
    <span class="hljs-built_in">edges</span>[edge.get_source()].<span class="hljs-built_in">append</span>(int(edge.get_destination()))
<span class="hljs-keyword">for</span> edge <span class="hljs-keyword">in</span> <span class="hljs-built_in">edges</span>:
    <span class="hljs-built_in">edges</span>[edge].<span class="hljs-built_in">sort</span>()
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):
        dest = graph.get_node(str(<span class="hljs-built_in">edges</span>[edge][i]))[<span class="hljs-number">0</span>]
graph.write_png(&lt;your file name here&gt;.png)
</code></pre>
    <p class="normal">The file will contain this intuitive decision tree:</p>
    <figure class="mediaobject"><img src="../Images/B15438_03_04.png" alt="Une image contenant signe, texte  Description générée automatiquement"/></figure>
    <p class="packt_figref">Figure 3.3: A decision tree</p>
    <p class="normal">The image produces the following information:</p>
    <ul>
      <li class="list">A decision tree<a id="_idIndexMarker125"/> represented as a graph that has nodes (the boxes) and edges (the lines).</li>
      <li class="list">When <em class="italics">gini</em>=0, this box is a <strong class="bold">leaf</strong>; the<a id="_idIndexMarker126"/> tree will grow no further.</li>
      <li class="list"><em class="italics">gini</em> means <strong class="bold">Gini impurity</strong>. At<a id="_idIndexMarker127"/> an intuitive level, Gini impurity will focus on the highest values of Gini impurity to classify the samples. We will go into the theory of Gini impurity in <em class="italics">Chapter 5</em>, <em class="italics">How to Use Decision Trees to Enhance K-Means Clustering</em>.</li>
      <li class="list"><em class="italics">samples</em> = 6. There are six samples in the training dataset:<ul>
          <li class="Bullet-Within-Bullet--PACKT-">Priority/location &lt;=360.0 is the largest division point that can be visualized:
        <pre class="programlisting"><code class="hljs angelscript">X = [[<span class="hljs-number">256</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>],
      [<span class="hljs-number">320</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>],
      [<span class="hljs-number">500</span>, <span class="hljs-number">1</span>,<span class="hljs-number">1</span>],
      [<span class="hljs-number">400</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>],
      [<span class="hljs-number">320</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>],
      [<span class="hljs-number">256</span>, <span class="hljs-number">1</span>,<span class="hljs-number">0</span>]]
</code></pre>
</li>
          <li class="Bullet-Within-Bullet-End--PACKT-">The false arrow points out the two values that are not &lt;=360. The ones that are classified as <code class="Code-In-Text--PACKT-">True</code> are considered as low-priority values.</li>
        </ul>
      </li>
    </ul>
    <p class="normal">After a few runs, the user will get used to visualizing the decision process as a white box and trust the system.</p>
    <p class="normal">Each ML tool suits a special need in a specific situation. In the next chapter, <em class="italics">Optimizing Your Solutions with K-Means Clustering</em>, we will explore another machine learning algorithm: <em class="italics">k-means clustering</em>.</p>
    <h1 id="_idParaDest-52" class="title">Summary</h1>
    <p class="normal">This chapter drew a distinction between machine intelligence and human intelligence. Solving a problem like a machine means using a chain of mathematical functions and properties. Machine intelligence surpasses humans in many fields.</p>
    <p class="normal">The further you get in machine learning and deep learning, the more you will find mathematical functions that solve the core problems. Contrary to the astounding amount of hype, mathematics relying on CPUs is replacing humans, not some form of mysterious conscious intelligence.</p>
    <p class="normal">The power of machine learning reaches beyond human <em class="italics">mathematical reasoning</em>. It makes ML generalization to other fields easier. A mathematical model, without the complexity of humans entangled in emotions, makes it easier to deploy the same model in many fields. The models of the first three chapters of this book can be used for self-driving vehicles, drones, robots in a warehouse, scheduling priorities, and much more. Try to imagine as many fields you can apply these to as possible.</p>
    <p class="normal">Evaluation and measurement are at the core of machine learning and deep learning. The key factor is constantly monitoring convergence between the results the system produces and the goal it must attain. The door is open to the constant adaptation of the parameters of algorithms to reach their objectives.</p>
    <p class="normal">When a human is surpassed by an unsupervised reinforcement learning algorithm, a decision tree, for example, can provide invaluable assistance to human intelligence.</p>
    <p class="normal">The next chapter, <em class="italics">Optimizing Your Solutions with K-Means Clustering</em>, goes a step further into machine intelligence.</p>
    <h1 id="_idParaDest-53" class="title">Questions</h1>
    <ol>
      <li class="list">Can a human beat a chess engine? (Yes | No)</li>
      <li class="list">Humans can estimate decisions better than machines with intuition when it comes to large volumes of data. (Yes | No)</li>
      <li class="list">Building a reinforcement learning program with a Q function is a feat in itself. Using the results afterward is useless. (Yes | No)</li>
      <li class="list">Supervised learning decision tree functions can be used to verify that the result of the unsupervised learning process will produce reliable, predictable results. (Yes | No)</li>
      <li class="list">The results of a reinforcement learning program can be used as input to a scheduling system by providing priorities. (Yes | No)</li>
      <li class="list">Can artificial intelligence software think like humans? (Yes | No)</li>
    </ol>
    <h1 id="_idParaDest-54" class="title">Further reading</h1>
    <ul>
      <li class="list">For more on decision trees: <a href="https://youtu.be/NsUqRe-9tb4"><span class="url">https://youtu.be/NsUqRe-9tb4</span></a></li>
      <li class="list">For more on chess analysis by experts such as Zoran Petronijevic, with whom I discussed this chapter: <a href="https://chessbookreviews.wordpress.com/tag/zoran-petronijevic/"><span class="url">https://chessbookreviews.wordpress.com/tag/zoran-petronijevic/</span></a>, <a href="https://www.chess.com/fr/member/zoranp"><span class="url">https://www.chess.com/fr/member/zoranp</span></a></li>
      <li class="list">For more on AI chess programs: <a href="https://deepmind.com/blog/article/alphazero-shedding-new-light-grand-games-chess-shogi-and-go"><span class="url">https://deepmind.com/blog/article/alphazero-shedding-new-light-grand-games-chess-shogi-and-go</span></a></li>
    </ul>
  </div>
</body></html>