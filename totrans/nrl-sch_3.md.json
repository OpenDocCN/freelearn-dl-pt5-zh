["```py\npip install numpy\npip install spacy\nspacy download en_core_web_md\n```", "```py\nfrom collections import defaultdict\nimport numpy as np\nimport spacy\nn_hyperplanes = 10\nnlp = spacy.load('en_core_web_md')\n# process 2 sentences using the model\ndocs = [\n    nlp('What a nice day today!'),\n    nlp('Hi how are you'),\n]\n# Get the mean vector for the entire sentence\nassert docs[0].vector.shape == (300,)\n# Random initialize 10 hyperplanes, dimension identical to embedding shape\nhyperplanes = np.random.uniform(-10, 10, (n_hyperplanes, docs[0].vector.shape[0]))\ndef encode(doc, hyperplanes):\n    code = np.dot(doc.vector, hyperplanes.T)  # dot product vector with norm vector\n    binary_code = np.where(code > 0, 1, 0)\n    return binary_code\ndef create_buckets(docs, hyperplanes):\n    buckets = defaultdict()\n    for doc in docs:\n        binary_code = encode(doc, hyperplanes)\n        binary_code = ''.join(map(str, binary_code))\n        buckets[binary_code] = doc.text\n    return buckets\nif __name__ == '__main__':\n    buckets = create_buckets(docs, hyperplanes)\n    print(buckets)\n```"]